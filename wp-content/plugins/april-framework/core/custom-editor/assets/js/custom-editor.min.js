function Custom_Editor(){this.editor=!1,this.formatter=!1,this.dom=!1,this.events={},this.init()}Custom_Editor.prototype={init_vars:function(){this.editor=tinyMCE.activeEditor,this.formatter=this.editor.formatter,this.dom=this.editor.dom},get_formatter_name:function(e){if("object"==typeof e)return e.formatter||e.command},get_formatter_value:function(e){if("object"==typeof e)return e.formatterValues},elm_isset:function(e){return void 0!==e&&null!==e},insert_p_tag_after:function(e){var t=this.dom.insertAfter(this.dom.create("p",{},"&nbsp;"),e),s=this.dom.createRng();s.setStart(t,0),s.setEnd(t,0),this.editor.selection.setRng(s)},append_elm:function(e,t,s,o){if(e&&e.appendChild){o=o||"p";var n=e.appendChild(this.dom.create(o,t,s)),i=this.dom.createRng();i.setStart(n,0),i.setEnd(n,0),this.editor.selection.setRng(i)}},on:function(e,t){void 0===this.events[e]&&(this.events[e]=[]),this.events[e].push(t)},dispatchEvent:function(e){var t=Array.prototype.slice.call(arguments,1),s=this;"object"==typeof this.events[e]&&this.events[e].forEach(function(e){e.apply(s,t)})},init:function(){var e=this;e.elm_isset(tinyMCE)&&e.elm_isset(tinyMCE.activeEditor)&&e.elm_isset(tinyMCE.activeEditor.formatter)?(this.init_vars(),this.register_all_formatters(),this.add_commands(),this.attach_event_listeners(),this.set_default_if_null()):jQuery(document).on("tinymce-editor-init",function(){e.init()})},each:function(e,t,s){if(!e)return 0;var o,n;if(s=s||e,void 0!==e.length){for(o=0,n=e.length;o<n;o++)if(!1===t.call(s,e[o],o,e))return 0}else for(o in e)if(e.hasOwnProperty(o)&&!1===t.call(s,e[o],o,e))return 0;return 1},is_current_user:function(){var e=this.editor.selection.getNode();return!(this.editor.selection.getNode().parentNode.hasAttribute("data-mce-bogus")||this.dom.isEmpty(e)||"&nbsp;"===tinymce.trim(e.innerHTML))},get_formatter_list:function(){return{gsf_blockquote_circle:{block:"blockquote",classes:"gsf-blockquote-circle"},gsf_blockquote_center:{block:"blockquote",classes:"gsf-blockquote-center"},gsf_blockquote_left:{block:"blockquote",classes:"gsf-blockquote-left"},gsf_blockquote_right:{block:"blockquote",classes:"gsf-blockquote-right"},gsf_dropcap_simple:{inline:"span",classes:"gsf-dropcap-default"},gsf_dropcap_square:{inline:"span",classes:"gsf-dropcap-square"},gsf_dropcap_square_outline:{inline:"span",classes:"gsf-dropcap-square-outline"},gsf_dropcap_circle:{inline:"span",classes:"gsf-dropcap-circle"},gsf_dropcap_circle_outline:{inline:"span",classes:"gsf-dropcap-circle-outline"},gsf_highlighted_yellow:{inline:"mark",classes:"gsf-highlighted-yellow"},gsf_highlighted_red:{inline:"mark",classes:"gsf-highlighted-red"},gsf_alert_simple:{block:"div",classes:"alert gsf-alert"},gsf_alert_success:{block:"div",classes:"alert alert-success"},gsf_alert_info:{block:"div",classes:"alert alert-info"},gsf_alert_warning:{block:"div",classes:"alert alert-warning"},gsf_alert_danger:{block:"div",classes:"alert alert-danger"},gsf_white_text:{inline:"span",classes:"gsf-white-text"}}},get_formatter:function(e){var t=this.get_formatter_list();if("object"==typeof t[e])return t[e]},register_all_formatters:function(){var e=this;e.each(this.get_formatter_list(),function(t,s){e.formatter.register(s,t)})},attach_event_listeners:function(){var e=this;e.editor.on("NewBlock",function(t){function s(){return!0}var o=e.editor.selection.dom.getPrev(t.newBlock,s);if(o)if("P"!=t.newBlock.tagName||/\bgsf\-.+/.test(t.newBlock.className))e.dom.isEmpty(o)?(e.insert_p_tag_after(t.newBlock),e.dom.remove(o),e.dom.remove(t.newBlock)):e.editor.dom.hasClass(o,"gsf-shortcode-col")&&(e.dom.isEmpty(t.newBlock)?e.append_elm(o):(e.append_elm(o),e.append_elm(o,{},t.newBlock.innerHTML)),e.dom.remove(t.newBlock));else if(e.get_parent_by_class(t.newBlock,"gsf-shortcode-col")&&"P"===o.tagName&&e.dom.isEmpty(o)){var n=e.get_parent_by_class(t.newBlock,"gsf-shortcode-row");e.editor.selection.dom.getNext(t.newBlock,s)||(e.insert_p_tag_after(n),e.dom.remove(t.newBlock))}})},set_default_if_null:function(){var e=this;e.on("after-formatter",function(t){e.is_current_user()||(/^\bgsf_dropcap.+/i.test(t)&&e.editor.insertContent("D"),/^\bgsf_highlight.*/i.test(t)&&(e.editor.insertContent("Highlighted text"),ins("Highlighted text")),/^gsf_alert_(.*?)$/i.exec(t)&&e.editor.insertContent("This is an alert message."))})},add_commands:function(){var e=this,t=e.editor;t.addCommand("gsf-formatter",function(s,o){e.formatter.toggle(e.get_formatter_name(o),e.get_formatter_value(o)),t.fire(o.command)}),t.addCommand("gsf_list_check",function(){t.execCommand("InsertUnorderedList",!1),null!==e.dom.getParent(t.selection.getNode(),"ul")&&e.toggleClass("gsf-list-check",/^(gsf-list-)+/,e.dom.getParent(t.selection.getNode(),"ul"))}),t.addCommand("gsf_list_star",function(){t.execCommand("InsertUnorderedList",!1),null!==e.dom.getParent(t.selection.getNode(),"ul")&&e.toggleClass("gsf-list-star",/^(gsf-list-)+/,e.dom.getParent(t.selection.getNode(),"ul"))}),t.addCommand("gsf_list_edit",function(){t.execCommand("InsertUnorderedList",!1),null!==e.dom.getParent(t.selection.getNode(),"ul")&&e.toggleClass("gsf-list-edit",/^(gsf-list-)+/,e.dom.getParent(t.selection.getNode(),"ul"))}),t.addCommand("gsf_list_folder",function(){t.execCommand("InsertUnorderedList",!1),null!==e.dom.getParent(t.selection.getNode(),"ul")&&e.toggleClass("gsf-list-folder",/^(gsf-list-)+/,e.dom.getParent(t.selection.getNode(),"ul"))}),t.addCommand("gsf_list_file",function(){t.execCommand("InsertUnorderedList",!1),null!==e.dom.getParent(t.selection.getNode(),"ul")&&e.toggleClass("gsf-list-file",/^(gsf-list-)+/,e.dom.getParent(t.selection.getNode(),"ul"))}),t.addCommand("gsf_list_heart",function(){t.execCommand("InsertUnorderedList",!1),null!==e.dom.getParent(t.selection.getNode(),"ul")&&e.toggleClass("gsf-list-heart",/^(gsf-list-)+/,e.dom.getParent(t.selection.getNode(),"ul"))}),t.addCommand("gsf_list_asterisk",function(){t.execCommand("InsertUnorderedList",!1),null!==e.dom.getParent(t.selection.getNode(),"ul")&&e.toggleClass("gsf-list-asterisk",/^(gsf-list-)+/,e.dom.getParent(t.selection.getNode(),"ul"))}),function(){function s(){var s;return s=t.selection.getNode(),t.dom.hasClass(s,"gsf-shortcode-row")?s:e.get_parent_by_class(s,"gsf-shortcode-row")}function o(t){var s=e.dom.select(".gsf-shortcode-col:first",t)[0];e.append_elm(s,{},r)}function n(s){if(s){var o=t.dom.createRng();o.setStart(s,0),o.setEnd(s,0),t.selection.setRng(o)}var n=e.dom.select(".gsf-shortcode-col",s);e.each(n,function(e){e.setAttribute("data-mce-contenteditable","true")})}function i(i,r){var a=t.selection.getNode();e.dom.remove(a),t.insertContent(i+a.outerHTML+r);var c=s();n(c),t.dom.isEmpty(a)&&o(c)}var r="Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt";t.addCommand("gsf_column_2",function(){i('<div class="row gsf-shortcode-row gsf-shortcode-row-2-column"><div class="col-xs-6 gsf-shortcode-col">','</div><div class="col-xs-6 gsf-shortcode-col">'+r+"</div></div>")}),t.addCommand("gsf_column_3",function(){i('<div class="row gsf-shortcode-row gsf-shortcode-row-3-column"><div class="col-xs-4 gsf-shortcode-col">','</div><div class="col-xs-4 gsf-shortcode-col">'+r+'</div><div class="col-xs-4 gsf-shortcode-col">'+r+"</div></div>")}),t.addCommand("gsf_column_4",function(){i('<div class="row gsf-shortcode-row gsf-shortcode-row-4-column"><div class="col-xs-3 gsf-shortcode-col">','</div><div class="col-xs-3 gsf-shortcode-col">'+r+'</div><div class="col-xs-3 gsf-shortcode-col">'+r+'</div><div class="col-xs-3 gsf-shortcode-col">'+r+"</div></div>")})}()},get_parent_by_class:function(e,t){for(var s=this.dom.getRoot(),o=e,n=!1;o&&o.parentNode&&o.parentNode!=s;)if(o=o.parentNode,t&&this.editor.dom.hasClass(o,t)){n=!0;break}if(!t||n)return o},get_parent_node:function(e,t){var s=this.dom.getRoot(),o=e,n=!1;for(t&&(t=t.toString().toUpperCase());o&&o.parentNode&&o.parentNode!=s;)if(o=o.parentNode,t&&o.tagName===t){n=!0;break}if(!t||n)return o},replace_vars:function(e,t){return"string"!=typeof e?e=e(t):t&&(e=e.replace(/%(\w+)/g,function(e,s){return t[s]||e})),e},check_active:function(e){if(!e)return!1;var t=1,s=this.editor.selection.getNode(),o=e.tagName&&!this.dom.isBlock(e.tagName)?s:this.get_parent_node(s,e.parent);return!!o&&(e.tagName&&(t=e.tagName.toUpperCase()===o.tagName),e.classes&&(t=this.editor.dom.hasClass(o,e.classes)),Boolean(t))},post_render_event:function(e){var t,s,o=this,n=e.settings;o.editor.on(n.command,function(){var i;if(t=o.get_formatter(o.get_formatter_name(n)))s=o.get_formatter_value(n),i={tagName:t.block||t.inline,classes:o.replace_vars(t.classes,s)};else{if(!n.activeConditions)return;i=n.activeConditions}var r=o.check_active(i);e.active(r)})},trigger_sub_menu:function(e){var t=this;t.each(e,function(e){e.command&&t.editor.fire(e.command)})},command_click_event:function(e){var t=e.settings.command;if(t){var s=this,o={name:""};s.each(e.parent().settings.items,function(e){o.name=e.command,o.name!==t&&s.check_active(e.activeConditions)&&s.editor.execCommand(o.name,!1)}),s.editor.execCommand(t,!1)}},formatter_click_event:function(e){var t,s=this,o={name:"",value:""};t=s.get_formatter_name(e.settings),this.each(e.parent().settings.items,function(e){if(o.name=s.get_formatter_name(e),o.value=s.get_formatter_value(e),o.name!==t){var n=s.formatter.get(o.name);!s.formatter.match(o.name,o.name)||"toggle"in n[0]&&!n[0].toggle||s.formatter.remove(o.name,o.name)}}),this.dispatchEvent("before-formatter",t,e),this.editor.execCommand("gsf-formatter",!1,e.settings),this.dispatchEvent("after-formatter",t,e)},raw_js_before_click_event:function(e){this.dispatchEvent("before-raw-js-click",e.settings,e)},raw_js_after_click_event:function(e){this.dispatchEvent("after-raw-js-click",e.settings,e)},toggleClass:function(e,t,s){var o,n=this,i=s?[s]:n.editor.selection.getSelectedBlocks();n.each(i,function(s){(o=n.dom.getAttrib(s,"class",!1))&&n.each(o.split(" "),function(o){n.each(e.split(" "),function(e){e!==o&&t.test(o)&&n.dom.toggleClass(s,o)})}),n.dom.toggleClass(s,e)})}};